<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:my="http://java.sun.com/jsf/composite"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
       xmlns:fn="http://java.sun.com/jsp/jstl/functions" 
      >
    <body>
	    <ui:composition>
			<header class="header">
            
            <a href="mostrarAV.xhtml" class="logo">${sessionScope.dAV.getNombreAV()} 
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top" role="navigation">
                <!-- Sidebar toggle button-->
                <a href="#" class="navbar-btn sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <div class="navbar-right">
                    <ul class="nav navbar-nav">
                        <!-- Messages: style can be found in dropdown.less-->
                        <li class="dropdown messages-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-envelope"></i>
                                <ui:param name="msjsNoLeidos" value="${usuarioBean.mostrarListaMsjNoLeidos()}"></ui:param>
                                <span class="label label-success">#{msjsNoLeidos.size()}</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">Tienes #{msjsNoLeidos.size()} mensaje/s</li>
                                <li>
                                    <!-- inner menu: contains the actual data -->
                                    <ul class="menu">
                                       <c:forEach var="m" items="#{msjsNoLeidos}"  >                            
                                        <li><!-- start message -->
                                   			
                                            <a href="mailbox.xhtml">
                                                <div class="pull-left">
                                                    <p:graphicImage value="#{usuarioBean.mostrarImagenUsuario()}" class="img-circle" alt="Usuario" cache="false"></p:graphicImage>
                                                </div>
                                                <h4>
                                                    ${m.getRemitente()}
                                                    <small><i class="fa fa-clock-o"></i> ${m.getFecha()}</small>
                                                </h4>
                                                
                                                <p> #{m.asunto}</p>
                                                <c:if test="#{ fn:length(m.getMensaje()) ge 10}">  
                                                       <p>#{m.getMensaje().substring(0,10)}</p>
                                                </c:if>
                                                <c:if test="#{ fn:length(m.getMensaje()) lt 10}">  
													<p>#{m.getMensaje()}</p>
                                                </c:if>
                                               
                                            </a>
                                        </li><!-- end message --> 
                                        </c:forEach>
                                    </ul>
                                </li>
                                <li class="footer"><a href="mailbox.xhtml">Ver todos los mensajes</a></li>
                            </ul>
                        </li>
                        <!-- Notifications: style can be found in dropdown.less -->
                        <li class="dropdown notifications-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-warning"></i>
                                <span class="label label-warning">10</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">Tienes 10 notificaciones</li>
                                <li>
                                    <!-- inner menu: contains the actual data -->
                                    <ul class="menu">
                                        <li>
                                            <a href="#">
                                                <i class="ion ion-ios7-people info"></i> 5 new members joined today
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="fa fa-warning danger"></i> Very long description here that may not fit into the page and may cause design problems
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="fa fa-users warning"></i> 5 new members joined
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="ion ion-ios7-cart success"></i> 25 sales made
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#">
                                                <i class="ion ion-ios7-person danger"></i> You changed your username
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="footer"><a href="#">Ver todo</a></li>
                            </ul>
                        </li>
                        <!-- Tasks: style can be found in dropdown.less -->
                        <li class="dropdown tasks-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-book"></i>
                                <span class="label label-danger">9</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">Hay 9 productos por comprar</li>
                                <li>
                                    <!-- inner menu: contains the actual data -->
                                    <ul class="menu">
                                        <li><!-- Task item -->
                                            <a href="#">
                                                <h3>
                                                    Leche x2
                                                </h3>
                                            </a>
                                        </li><!-- end task item -->
                                        <li><!-- Task item -->
                                            <a href="#">
                                                <h3>
                                                    Queso x1
                                                </h3>
                                            </a>
                                        </li><!-- end task item -->
                                        <li><!-- Task item -->
                                            <a href="#">
                                                <h3>
                                                    Lechuga x2
                                                </h3>
                                            </a>
                                        </li><!-- end task item -->
                                        <li><!-- Task item -->
                                            <a href="#">
                                                <h3>
                                                    Cebolla x3
                                                </h3>
                                            </a>
                                        </li><!-- end task item -->
                                    </ul>
                                </li>
                                <li class="footer">
                                    <a href="#">Ver lista completa</a>
                                </li>
                            </ul>
                        </li>
                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="glyphicon glyphicon-user"></i>
                                <span>${usuarioBean.nick}<i class="caret"></i></span>
                            </a>
                            
	                            <ul class="dropdown-menu">
	                                <!-- User image -->
	                                <li class="user-header bg-light-blue">
	                                    
	                                    <p>
	                                        ${usuarioBean.nick}
	                                    </p>
	                                </li>
	                                <!-- Menu Footer-->
	                                <li class="user-footer">
	                                    <div class="pull-left">
	                                        <a href="usuario_sapo.xhtml" class="btn btn-default btn-flat">Perfil</a>
	                                    </div>
	                                    <div class="pull-right">
	                                       <h:form>
	                                  			<h:commandButton  action="#{usuarioBean.logout()}" value="Cerrar sesion" class="btn btn-default btn-flat" />   	
	                                    	</h:form>
	                                    </div>
	                                </li>
	                            </ul>
                            
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
				
	    </ui:composition>
    </body>
</html>
